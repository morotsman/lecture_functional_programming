<!DOCTYPE html>
<html>
<head lang="en">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Demo</title>


    <!--App lib BEGIN-->
	<script type="text/javascript" src="lib/L/L.js"></script>
        <script src="https://unpkg.com/rxjs/bundles/Rx.min.js"></script>
    <!--App lib END-->

   

</head>
<body>
    
    <div>
        <input type="text" id="textInput"></input>
        <button id="buttonInput">Add</button>
    </div>
    
    
    </br>
    
    <div>
        <span>Anagrams</span>
        <table id="output">
            
        </table>
    </div>
    

</body>

<script>
    
    const sortedString = string => string.split("").sort().join("")
    const objectValues = obj => Object.keys(obj).map(key => obj[key]);
    const removeChilds = element => {
        while (element.firstChild) {
            element.removeChild(element.firstChild);
        }
    }
    
    const buttonSource = Rx.Observable
            .fromEvent(document.getElementById("buttonInput"), 'click')
            
    const enterSource = Rx.Observable
            .fromEvent(document.getElementById("textInput"), 'keydown')
            .filter(key => key.code === "Enter");
    
    const source = Rx.Observable.merge(buttonSource,enterSource).map(event => document.getElementById("textInput").value);
    
    const anagrams = source
            .distinct()
            .scan((acc, cur) => {
                const key = sortedString(cur);
                acc[key] = acc[key]?acc[key].concat([cur]):[cur];
                return acc;
            }, {})
            .map(group => objectValues(group).filter(words => words.length > 1))
            .distinct(anagrams => anagrams.join(""))
            
            
            
    anagrams.subscribe(anagrams => {
        console.log(anagrams);
        const output = document.getElementById("output");
        removeChilds(output)
        anagrams.forEach(anagram => { 
           output.insertAdjacentHTML('beforeend', "<tr>" + anagram + "</tr>"); 
        })
        
    });
   
   
    
</script>
</html>